## gettelegrammessages

Скрипты на Node.js для авторизации в Telegram (через gramJS) и выгрузки сообщений чата/группы в CSV.

### Возможности
- **Авторизация** через номер телефона, поддержка 2FA
- **Сохранение сессии** в переменную `TELEGRAM_SESSION` (в `.env`)
- **Выгрузка сообщений** из чата/группы в CSV (`output/messages_*.csv`)

### Требования
- Node.js 18+
- Аккаунт Telegram и доступ к `https://my.telegram.org` для получения `API ID` и `API Hash`

### Установка
```bash
npm install
```

### Получение API-данных
Если у вас ещё нет `TELEGRAM_API_ID` и `TELEGRAM_API_HASH`:
```bash
npm run get-creds
```
Скрипт подскажет, где получить значения, и выведет строки для добавления в `.env`.

### Конфигурация окружения
Создайте в корне файл `.env` со следующими переменными:
```bash
TELEGRAM_API_ID=123456
TELEGRAM_API_HASH=your_api_hash
TELEGRAM_PHONE=+79991234567
# Будет добавлено автоматически после первого входа
TELEGRAM_SESSION=
# Куда сохранять CSV-файлы
OUTPUT_DIR=./output
```

Примечания:
- После первой авторизации скрипт сам сохранит `TELEGRAM_SESSION` в `.env`.
- Папка, указанная в `OUTPUT_DIR`, будет создана автоматически.

### Запуск выгрузки сообщений
```bash
npm start
```
Вас попросят ввести:
- код из Telegram (при первом запуске)
- 2FA-пароль (если включён)
- `ID` чата/группы, откуда нужно скачать сообщения

После завершения появится CSV-файл вида `output/messages_<chatId>_<chatTitle>.csv`.

### Где взять ID чата
Во время запуска скрипт выведет список ваших диалогов с их `id`. Можно ввести его оттуда. Также можно использовать username (например, `@channelusername`).

### Скрипты
- `npm run get-creds` — подсказки по получению API-данных и вывод строк для `.env`
- `npm start` — авторизация (gramJS), вывод диалогов и скачивание сообщений в CSV

### Структура
- `download_with_gramjs.js` — основной скрипт авторизации и выгрузки сообщений
- `get_telegram_credentials.js` — подсказки и сбор данных для `.env`

### Лицензия
MIT
